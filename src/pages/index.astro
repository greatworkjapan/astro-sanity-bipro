import Layout from "../layouts/Layout.astro"
import { client } from "../lib/sanity"
const posts = await client.fetch(`
  *[_type=="post"] | order(publishedAt desc)[0..9]{
    title, excerpt, "slug": slug.current, publishedAt
  }
`)
---

<Layout title="ホーム" addTitleSuffix={true} description="最新記事">
  <main class="px-4 sm:px-6 py-10">
    <section class="mx-auto max-w-7xl">
      <h1 class="text-3xl sm:text-4xl font-black">最新記事</h1>
      <ul class="mt-8 grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {posts.map((p:any)=>(
          <li class="card card-border bg-base-100 shadow-sm transition hover:shadow-md">
            <a class="block p-5" href={`/blog/${p.slug}`}>
              <h3 class="text-lg font-bold line-clamp-2">{p.title}</h3>
              <div class="mt-2 text-xs text-base-content/60">{new Date(p.publishedAt).toLocaleDateString('ja-JP')}</div>
              {p.excerpt && <p class="mt-3 text-sm text-base-content/80 line-clamp-3">{p.excerpt}</p>}
            </a>
          </li>
        ))}
      </ul>

      <div class="mt-8 text-right">
        <a class="btn btn-primary btn-sm sm:btn-md" href="/blog">→ すべてのブログ記事</a>
      </div>
    </section>
  </main>
  
</Layout>
